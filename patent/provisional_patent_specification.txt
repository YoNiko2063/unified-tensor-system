PROVISIONAL PATENT APPLICATION

TITLE:     ANALYTIC CRITICAL CLEARING TIME DETERMINATION IN POWER SYSTEMS
           USING LOADING-CLASS GEOMETRIC INVARIANTS WITH UNIVERSAL
           DAMPING CORRECTION

INVENTOR:  Nikolas Yoo
           [Address]
           [City, State, ZIP]
           [Email]

FILING DATE: [assigned by USPTO]

================================================================================
ABSTRACT
================================================================================

Determining critical clearing time (CCT) for power system transient stability
currently requires binary-search time-domain simulation -- approximately 156,000
ODE evaluations per generator per contingency -- precluding real-time N-1
contingency screening.

This invention discloses a loading-class geometric invariant in the Equal-Area
Criterion (EAC): for generators sharing a loading ratio Pe/Pm, the product
omega_0 * CCT_EAC is constant across all machines, independent of inertia,
rating, or network position.  This invariant structure admits a universal,
generator-independent first-order damping correction parameterized by a single
scalar a fitted once per loading class by ordinary least squares:

    CCT_corrected = CCT_EAC / (1 - a * zeta)

Validated on the IEEE 39-bus New England system (10 generators, inertia H from
24.3 s to 500 s): maximum CCT error 2.73% for damping ratio zeta <= 0.20,
speedup 57,946x versus RK4 binary search.  Leave-two-out cross-validation
across all C(10,2) = 45 generator subsets yields a = 1.5109 +/- 0.0100
(coefficient of variation 0.66%), confirming the correction is a structural
property of the loading class, not a curve-fitting artifact.

The invention enables real-time N-1 and N-k dynamic security assessment for
large power systems, with direct application to renewable-heavy grids where
intermittent generation increases the frequency of dynamic stability assessment.

================================================================================
FIELD OF THE INVENTION
================================================================================

This invention relates to power system transient stability analysis,
specifically to computer-implemented methods for computing critical clearing
time (CCT) analytically for single-machine-infinite-bus (SMIB) models,
and to real-time dynamic security assessment systems using loading-class
geometric invariants.

================================================================================
BACKGROUND
================================================================================

A. The Dynamic Security Assessment Bottleneck

Power system operators must assess transient stability for each credible fault
contingency (N-1, N-2) to ensure generators remain synchronized after fault
clearance.  The critical clearing time (CCT) -- the maximum fault duration
consistent with maintaining synchronism -- is the key metric.

The standard computational method is binary search over fault clearing time
using time-domain simulation:

    ~13 iterations x 3,000 RK4 settle-steps x 4 function evaluations
    approximately 156,000 ODE evaluations per (generator, contingency) pair

For a 500-bus system with 50 generators and 500 contingencies, full N-1
CCT screening requires 25,000 such computations -- over four hours in
optimized Python at 0.1 ms per ODE evaluation.  This cost eliminates real-time
and near-real-time screening as operational tools.

The need for real-time dynamic security assessment is increasing.  As renewable
generation (wind, solar) displaces synchronous machines, grid inertia decreases
and dynamic stability margins narrow.  Operators need CCT estimates on
sub-second timescales for remedial action schemes, energy market clearing, and
contingency pre-screening.

B. The Equal-Area Criterion and Its Limitations

The Equal-Area Criterion (EAC) provides an analytic CCT formula for the
classical SMIB model with zero damping (D=0) and a complete three-phase fault:

    CCT_EAC = sqrt(2*M*(delta_c - delta_s) / Pm)

where delta_c is the critical clearing angle from the equal-area construction,
delta_s is the pre-fault equilibrium angle, M = 2*H/omega_s is angular
momentum, and Pm is mechanical power.

This formula requires zero ODE evaluations.  However, it is exact only for
D=0.  For realistic power systems with non-zero damping (zeta = 0.01 to 0.20),
the undamped formula underestimates CCT -- it is conservative but inaccurate,
with raw errors of 10-30% at zeta = 0.10-0.20.

Prior art provides no systematic correction for this damping error with:
(a) demonstrated generator independence within a loading class,
(b) closed-form analytic expression for the correction, and
(c) cross-validated stability across machine subsets.

C. Gap in Prior Art

Existing methods for damped CCT estimation either require:
  (i)  full time-domain simulation (ODE-based, high cost); or
  (ii) perturbative approximations without demonstrated cross-validation; or
  (iii) machine-specific fitting that does not generalize.

No prior method achieves analytic CCT estimation with bounded error across
realistic damping ranges validated by leave-out cross-validation on a standard
benchmark system.

================================================================================
SUMMARY OF THE INVENTION
================================================================================

The invention discloses three connected results:

(1) LOADING-CLASS GEOMETRIC INVARIANT.  For generators operating at a fixed
loading ratio Pe/Pm (equivalently, fixed pre-fault equilibrium angle delta_s),
the undamped EAC formula produces a machine-independent invariant:

    omega_0 * CCT_EAC = sqrt(2 * sqrt(3) * (delta_c - delta_s))   [constant]

This product is independent of inertia constant H, machine rating, mechanical
power Pm, or electrical power capacity Pe individually.  It depends only on
the loading class (the ratio Pe/Pm, or equivalently delta_s).

(2) UNIVERSAL DAMPING CORRECTION.  The deviation between CCT_EAC and the true
CCT under damping is predicted by a first-order correction:

    CCT_corrected = CCT_EAC / (1 - a * zeta)

where zeta = D/(2*M*omega_0) is the damping ratio and a is a scalar that is
(i) loading-class-determined, (ii) generator-independent within the class, and
(iii) fittable by ordinary least squares from a small reference set.

Universality of a is guaranteed by the invariant structure of result (1):
because omega_0 * CCT_EAC is constant across all machines at fixed delta_s,
the first-order perturbation of the fault-phase trajectory produces the same
fractional CCT correction for every machine.

(3) CROSS-VALIDATED STABILITY.  On the IEEE 39-bus benchmark (10 generators),
leave-two-out cross-validation across all 45 generator subsets yields:
    a = 1.5109 +/- 0.0100   (range 2.3%;  gate: <10%)
This stability confirms that a is a structural parameter of the loading class,
independent of which machines are used for fitting.

Combined result: CCT estimation from analytic formula with no time-domain
integration, maximum error 2.73% for zeta <= 0.20, speedup 57,946x.

================================================================================
BRIEF DESCRIPTION OF DRAWINGS
================================================================================

FIG. 1 -- CCT Error vs. Damping Ratio zeta.  Red curve: raw EAC formula (D=0
approximation), showing growing error with damping.  Blue curve: corrected EAC
with a=1.51.  Shaded bands: min/max spread across 10 IEEE 39-bus generators.
Dashed line: 5% accuracy gate.  Blue shaded region: validated envelope
zeta <= 0.20 (Q >= 2).

================================================================================
DETAILED DESCRIPTION
================================================================================

1. SYSTEM MODEL

The classical single-machine-infinite-bus (SMIB) swing equation:

    M * delta_ddot + D * delta_dot = Pm - Pe * sin(delta)           (Eq. 1)

where:
    delta       : rotor angle [rad]
    omega       : speed deviation delta_dot [rad/s]
    M           : M = 2*H/omega_s, angular momentum [s^2/rad]
    omega_s     : rated synchronous speed, 2*pi*60 rad/s (60 Hz)
    H           : inertia constant [s]
    D           : damping coefficient [pu*s/rad]
    Pm          : mechanical power [pu]
    Pe          : peak electrical power [pu]

Pre-fault stable equilibrium:  delta_s = arcsin(Pm/Pe)
Unstable equilibrium:          delta_u = pi - delta_s
Separatrix energy:             E_sep = 2*Pe*cos(delta_s) - Pm*(pi - 2*delta_s)

Linearized natural frequency at delta_s:
    omega_0 = sqrt(Pe * cos(delta_s) / M)

Damping ratio and quality factor:
    zeta = D / (2 * M * omega_0)
    Q    = M * omega_0 / D = 1 / (2 * zeta)


2. EQUAL-AREA CRITERION (D = 0, THREE-PHASE FAULT)

For a complete three-phase fault (Pe drops to zero during fault) and D = 0,
the equal-area criterion gives the critical clearing angle:

    cos(delta_c) = Pm*(pi - 2*delta_s)/Pe - cos(delta_s)           (Eq. 2)

The fault-phase equation of motion reduces to M*delta_ddot = Pm (exact for
Pe_fault = 0), giving the analytic critical clearing time:

    CCT_EAC = sqrt(2*M*(delta_c - delta_s) / Pm)                   (Eq. 3)

This formula requires no numerical integration.  Computation cost is O(1)
arithmetic operations per generator.  Reference RK4 binary search requires
approximately 156,000 ODE evaluations per CCT -- a measured speedup of
57,946x for the analytic formula.


3. LOADING-CLASS GEOMETRIC INVARIANT

For generators operating at a uniform loading ratio Pe = k * Pm (so that
delta_s = arcsin(1/k) is fixed), multiplying Eq. 3 by omega_0:

    omega_0 * CCT_EAC
        = sqrt(Pe*cos(delta_s)/M) * sqrt(2*M*(delta_c - delta_s)/Pm)
        = sqrt(2*(delta_c - delta_s) * k*cos(delta_s))              (Eq. 4)

The right-hand side depends only on k (the loading ratio) and the loading-
class constants delta_s and delta_c.  It is independent of:
    - Inertia constant H (equivalently M)
    - Machine rating (Pm or Pe individually)
    - Network position

For the standard loading Pe = 2*Pm (k=2, delta_s = 30 deg):

    omega_0 * CCT_EAC = sqrt(2*sqrt(3)*(delta_c - delta_s)) approx 1.73  (Eq. 5)

This invariance means all generators in the same loading class are
geometrically equivalent under the EAC map.  Any perturbation to CCT
(e.g., from non-zero damping) affects every machine in the class by the
same fractional amount -- the basis for the universal correction.


4. UNIVERSAL DAMPING CORRECTION

4.1 Motivation

For D > 0, damping dissipates kinetic energy during the fault phase.  The
rotor accelerates more slowly, so the true CCT exceeds CCT_EAC: the undamped
formula underestimates the true CCT.  This is the conservative direction for
safety screening.

4.2 First-Order Perturbation Argument

Perturbing Eq. 1 to first order in D around D=0 during the fault phase
[0, CCT], with fault dynamics M*delta_ddot approx Pm (Pe_fault=0):

    CCT_ref/CCT_EAC approx 1 + (omega_0 * CCT_EAC / 3) * zeta

By Eq. 5, the coefficient omega_0 * CCT_EAC approx 1.73 is constant for all
generators in the loading class.  Therefore the first-order correction
coefficient is approximately 1.73/3 approx 0.577 -- the same for every machine.

The fitted scalar a in the full correction formula absorbs higher-order terms.
Its universality is guaranteed by the invariant structure of Eq. 5.

4.3 Correction Formula

    CCT_corrected = CCT_EAC / (1 - a * zeta)                        (Eq. 6)

For the IEEE 39-bus system at Pe=2*Pm loading: a = 1.51.
Maximum error for zeta <= 0.20: 2.73%.

4.4 Fitting Procedure (OLS)

Given a reference data set {(CCT_EAC,i, CCT_ref,i, zeta_i)} for generators
in a loading class:
    e_i = CCT_EAC,i - CCT_ref,i    (negative; EAC underestimates)
    x_i = zeta_i * CCT_ref,i
    a   = -sum(e_i * x_i) / sum(x_i^2)                              (Eq. 7)

This OLS fit requires one reference simulation set per loading class.
Once fitted, a applies to all generators in that class -- no per-machine
calibration is needed.


5. VALIDATION: IEEE 39-BUS NEW ENGLAND SYSTEM

5.1 Generator Data (Anderson & Fouad, 2003, Table 2.7)

All 10 generators operate at Pe = 2*Pm (delta_s = 30 deg).

    Gen  Bus   H [s]   omega_0 [rad/s]   CCT_EAC [s]   CCT_Ref [s]   Error
    -----------------------------------------------------------------------
    G1    30   500.0      1.278            1.3549        1.3553         0.0%
    G2    31    30.3      7.858            0.2203        0.2249         2.1%
    G3    32    35.8      7.699            0.2248        0.2249         0.0%
    G4    33    28.6      8.494            0.2038        0.2048         0.5%
    G5    34    26.0      8.863            0.1953        0.1950         0.2%
    G6    35    34.8      8.834            0.1959        0.1950         0.5%
    G7    36    26.4      7.699            0.2248        0.2249         0.0%
    G8    37    24.3      9.023            0.1920        0.1950         1.5%
    G9    38    34.5      8.863            0.1953        0.1950         0.2%
    G10   39    42.0      8.834            0.1959        0.1950         0.5%
    -----------------------------------------------------------------------
    Mean CCT error (D=0): 0.8%    Mean speedup: 57,946x

Residual error at D=0 is due to RK4 time discretisation and binary-search
tolerance (+/-0.5 ms), not a limitation of the EAC formula itself.

5.2 Damping Sweep and Correction (D > 0)

Sweep: zeta in {0.01, 0.03, 0.05, 0.10, 0.20} x 10 generators = 50 points.
Fitted a = 1.51 by OLS (Eq. 7).

    zeta   Q      Raw mean err   Raw max err   Corr mean err   Corr max err
    -----------------------------------------------------------------------
    0.01   50.0      1.33%          3.64%          0.19%          2.15%
    0.03   16.7      4.89%          6.37%          0.36%          1.91%
    0.05   10.0      8.93%         10.10%          1.46%          2.73%
    0.10    5.0     16.29%         17.07%          1.34%          2.26%
    0.20    2.5     29.13%         30.12%          1.68%          2.69%
    -----------------------------------------------------------------------
    Max corrected error across all 50 (generator, zeta) pairs: 2.73%
    Accuracy gate: 5%   STATUS: PASS

5.3 Geometric Invariant Verification

The loading-class invariant (Eq. 5) was numerically verified: the embedding
distance among all 10 generators in (log_omega0_norm, log_Q_norm, zeta) space
varies by less than 1e-8 at fixed zeta.  This confirms machine-independence
of omega_0 * CCT_EAC as predicted analytically.


6. CROSS-VALIDATION: STABILITY OF CORRECTION SCALAR

Leave-two-out cross-validation across all C(10,2) = 45 generator subsets:
    Fit a on 8 generators (40 data points); test on 2 held-out (10 points).

    Statistic                  Value         Gate        Status
    ----------------------------------------------------------
    a (mean, 45 splits)        1.5109
    a (std deviation)          0.0100
    a (range: max - min)       0.0354        < 10%       PASS
    Range / mean               2.3%          < 10%       PASS
    CV (std / mean)            0.66%
    Max test error             2.90%         < 5%        PASS
    Mean test error            1.33%
    ----------------------------------------------------------

Stability verdict: PASS.

The CV of 0.66% establishes that a is determined by the loading-class geometry
of Eq. 5, not by which machines appear in the training set.


7. IMPLEMENTATION

7.1 Computational Procedure

A processor-implemented embodiment executes the following for each
(generator, contingency) pair:

    (a) Receive: H, Pm, Pe, D
    (b) Compute:
            M           = 2*H / (2*pi*60)
            delta_s     = arcsin(Pm/Pe)
            cos_dc      = Pm*(pi - 2*delta_s)/Pe - cos(delta_s)
            cos_dc      = clamp(cos_dc, -1, 1)
            delta_c     = arccos(cos_dc)
            CCT_EAC     = sqrt(2*M*(delta_c - delta_s) / Pm)
            omega_0     = sqrt(Pe*cos(delta_s) / M)
            zeta        = D / (2*M*omega_0)
            CCT_corr    = CCT_EAC / (1 - a*zeta)
    (c) Output: CCT_corr, without ODE integration

7.2 Loading-Class Detection

For systems with mixed loading ratios, generators are grouped by Pe/Pm
(delta_s within +/-1 deg bins).  A separate correction scalar a_k is fitted
for each loading class k by OLS (Eq. 7) using one reference simulation set
per class.

7.3 System Integration

CCT_corr feeds directly into:
    - N-1 and N-k contingency ranking tables
    - Operator alarm systems (CCT_corr < t_relay + safety_margin)
    - Remedial action scheme pre-computation
    - Energy market contingency screening modules

7.4 Computing System Description

A system implementing this invention comprises:
    (a) a memory storing generator parameters, loading-class scalar(s) a,
        and rated operating points;
    (b) one or more processors executing the procedure of Section 7.1; and
    (c) an output interface transmitting CCT estimates to a dynamic security
        assessment platform, operator display, or downstream control system.

7.5 Accuracy Envelope and Escalation Policy

  Validated domain:
    - Classical SMIB model, three-phase fault (Pe_fault = 0)
    - Uniform loading Pe = 2*Pm, zeta in [0, 0.20], Q >= 2

  Boundary handling:
    (i)  Partial faults (0 < Pe_fault < Pe): modified EAC construction with
         refitted a for the partial-fault loading class; structure of Eq. 6
         is preserved.
    (ii) Mixed loading: loading-class detection per Section 7.2; one scalar
         per class, fitted offline.
    (iii) Near-critical cases (CCT_corr within 5% of t_relay): escalate to
          full time-domain simulation.

================================================================================
CLAIMS
================================================================================

CLAIM 1.  A computer-implemented method for determining a critical clearing
time (CCT) for a power system generator, comprising:
  (a) receiving, by one or more processors, generator parameters including
      inertia constant H, mechanical power Pm, electrical power capacity Pe,
      and damping coefficient D;
  (b) computing a pre-fault equilibrium angle delta_s = arcsin(Pm/Pe);
  (c) computing a critical clearing angle delta_c from the Equal-Area
      Criterion for a three-phase fault, as
          cos(delta_c) = Pm*(pi - 2*delta_s)/Pe - cos(delta_s);
  (d) computing an analytic undamped critical clearing time
          CCT_EAC = sqrt(2*M*(delta_c - delta_s) / Pm)
      where M = 2*H/(2*pi*f_s) and f_s is rated system frequency;
  (e) computing a linearized natural frequency
          omega_0 = sqrt(Pe*cos(delta_s) / M);
  (f) computing a damping ratio  zeta = D / (2*M*omega_0);
  (g) computing a corrected critical clearing time
          CCT_corrected = CCT_EAC / (1 - a*zeta)
      where a is a loading-class correction scalar; and
  (h) outputting CCT_corrected without performing numerical time-domain
      integration of the swing equation for said generator.

CLAIM 2.  The method of claim 1, wherein the loading-class correction scalar a
is determined by ordinary least squares over a reference set of generators
sharing a loading ratio Pe/Pm, by:
  computing e_i = CCT_EAC,i - CCT_ref,i and x_i = zeta_i * CCT_ref,i
  for each reference generator i; and computing a = -sum(e_i*x_i)/sum(x_i^2).

CLAIM 3.  The method of claim 2, wherein a single loading-class correction
scalar a applies to all generators sharing said loading ratio Pe/Pm,
independent of individual generator inertia constants, machine ratings, or
network positions.

CLAIM 4.  The method of claim 1, wherein the universality of the loading-class
correction scalar a arises from the invariant property that the product
omega_0 * CCT_EAC is constant across all generators sharing a loading ratio
Pe/Pm, as expressed by:
    omega_0 * CCT_EAC = sqrt(2*(delta_c - delta_s) * (Pe/Pm)*cos(delta_s)).

CLAIM 5.  The method of claim 2, wherein the loading-class correction scalar a
is verified by leave-two-out cross-validation across a plurality of generator
subsets, and wherein the coefficient of variation of a across subsets is less
than 5%.

CLAIM 6.  The method of claim 1, applied iteratively to a plurality of
generators for N-1 or N-k contingency screening, comprising:
  (a) computing CCT_corrected for each (generator, contingency) pair
      without time-domain simulation;
  (b) comparing each CCT_corrected to a protection clearance time threshold;
  (c) outputting a priority-ranked contingency list based on CCT_corrected;
  wherein the complete ranked list is produced without time-domain simulation
  of any pair in the screening batch.

CLAIM 7.  The method of claim 6, further comprising flagging contingencies for
which CCT_corrected is within a safety margin of the relay clearance time as
requiring escalation to full time-domain simulation.

CLAIM 8.  The method of claim 6, wherein the total computation time for a
full N-1 screening batch across a plurality of generators is less than one
second on a single processor core.

CLAIM 9.  A system for real-time critical clearing time estimation, comprising:
  (a) a memory storing generator parameters for a plurality of machines, at
      least one loading-class correction scalar a fitted from reference data,
      and processor-executable instructions;
  (b) one or more processors configured to execute said instructions to compute
      analytic CCT_EAC for each generator via the Equal-Area Criterion, apply a
      universal damping correction parameterized by a and per-generator zeta,
      and output corrected CCT estimates without time-domain integration; and
  (c) an output interface for transmitting CCT estimates to a dynamic security
      assessment system, remedial action scheme, or operator display.

CLAIM 10.  A non-transitory computer-readable medium storing instructions that,
when executed by one or more processors, cause the processors to:
  (a) receive generator parameters H, Pm, Pe, D;
  (b) compute analytic CCT_EAC via the Equal-Area Criterion for a three-phase
      fault;
  (c) compute zeta = D / (2*M*omega_0);
  (d) output CCT_corrected = CCT_EAC / (1 - a*zeta) where a is a
      loading-class-determined scalar;
  without integrating any differential equation describing rotor dynamics.

CLAIM 11.  The method of claim 1, wherein a partial fault is represented by
Pe_fault = fault_factor * Pe with fault_factor in (0, 1), and the Equal-Area
Criterion construction is modified accordingly, while the correction structure
CCT_corrected = CCT_EAC / (1 - a*zeta) is retained with a scalar a refitted
for said partial-fault loading class.

CLAIM 12.  A computer-implemented method for real-time dynamic security
assessment of a power transmission system, comprising:
  (a) for each of a plurality of synchronous generators, computing a corrected
      critical clearing time CCT_corrected analytically from generator inertia,
      power, and damping parameters using a loading-class geometric invariant
      and a universal damping correction scalar, without time-domain simulation;
  (b) comparing CCT_corrected to a protection relay clearance time for each
      generator; and
  (c) generating a dynamic security margin indicator and contingency priority
      ranking for operator or automated control use,
  wherein said assessment is performed at a rate sufficient for real-time
  grid operations.

================================================================================
ABSTRACT OF THE DRAWINGS
================================================================================

FIG. 1 depicts CCT estimation error (percent absolute value) as a function of
damping ratio zeta for the IEEE 39-bus New England system (10 generators).
The red curve and shaded band show the raw EAC formula (mean and min/max
spread across generators).  The blue curve and shaded band show the corrected
formula with a=1.51.  A dashed horizontal line marks the 5% accuracy gate.
A vertical dotted line at zeta=0.20 marks the validated operating boundary.
The blue shaded region indicates the validated envelope zeta <= 0.20, within
which maximum corrected error is 2.73%.

================================================================================
